###############################################################################
# ZapPRO AjudaTec - Environment Variables
# 
# Este arquivo contém TODAS as variáveis de ambiente necessárias para:
# - Desenvolvimento local com Docker Compose (Supabase local)
# - Deploy na Vercel (produção)
#
# INSTRUÇÕES:
# 1. Copie este arquivo para .env
# 2. Preencha os valores conforme seu ambiente
# 3. NUNCA commit .env com valores reais
###############################################################################

#------------------------------------------------------------------------------
# SEÇÃO 1: INFRAESTRUTURA DOCKER/SUPABASE (Desenvolvimento Local)
# Usado por: docker-compose.yml, Supabase CLI
# Deploy Vercel: NÃO necessário (usa Supabase Cloud)
#------------------------------------------------------------------------------

# PostgreSQL Database
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_DB=postgres
POSTGRES_PASSWORD=postgres

# Supabase Studio
STUDIO_DEFAULT_ORGANIZATION=ZapPRO
STUDIO_DEFAULT_PROJECT=Local
PG_META_CRYPTO_KEY=dev_pg_meta_key

# Supabase Auth (GoTrue)
API_EXTERNAL_URL=http://localhost:9999
SITE_URL=http://localhost:3001
JWT_SECRET=dev_super_secret_jwt
JWT_EXPIRY=3600

# Supabase Keys (gerados pelo Supabase CLI ou painel)
# Generate with: openssl rand -base64 32
ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiJ9.dev
SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoic2VydmljZV9yb2xlIn0.dev

# Supabase Dashboard
DASHBOARD_USERNAME=admin
DASHBOARD_PASSWORD=admin

# PostgREST
PGRST_DB_SCHEMAS=public,storage,_analytics

# Supabase Analytics (Logflare)
LOGFLARE_PUBLIC_ACCESS_TOKEN=public_dev_token
LOGFLARE_PRIVATE_ACCESS_TOKEN=private_dev_token

# Supabase Storage & Image Proxy
IMGPROXY_ENABLE_WEBP_DETECTION=true

# Supabase Realtime & Edge Functions
SECRET_KEY_BASE=dev_secret_key_base
VAULT_ENC_KEY=dev_vault_key
FUNCTIONS_VERIFY_JWT=false

# Supabase Connection Pooler (Supavisor)
POOLER_TENANT_ID=local
POOLER_DEFAULT_POOL_SIZE=5
POOLER_MAX_CLIENT_CONN=100
POOLER_DB_POOL_SIZE=10

# Docker Images
NODE_IMAGE=node:20-alpine

#------------------------------------------------------------------------------
# SEÇÃO 2: APLICAÇÃO NEXT.JS (apps/saas)
# Usado por: Desenvolvimento local E Deploy Vercel
#------------------------------------------------------------------------------

## 2.1 - URLs Públicas (Client-Side)
# Dev local: http://localhost:3001
# Vercel: https://seu-dominio.vercel.app
NEXT_PUBLIC_WEBSITE_URL=http://localhost:3001
NEXT_PUBLIC_APP_URL=http://localhost:3001

## 2.2 - Supabase (Client)
# Dev local (Docker Compose): http://localhost:8000
# Dev local (Supabase CLI): http://localhost:54321
# Vercel: https://seu-projeto.supabase.co
NEXT_PUBLIC_SUPABASE_URL=http://localhost:8000
NEXT_PUBLIC_SUPABASE_ANON_KEY=

## 2.3 - Supabase (Server-Side)
# Dev local (Docker Compose): http://kong:8000 (interno)
# Dev local (Supabase CLI): http://localhost:54321
# Vercel: https://seu-projeto.supabase.co
SUPABASE_URL=http://kong:8000
SUPABASE_SERVICE_ROLE_KEY=

## 2.4 - Stripe (Pagamentos)
# Obrigatório para: Landing page, checkout, webhooks
# Onde usar: Vercel E desenvolvimento local
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
NEXT_PUBLIC_STRIPE_PRICING_TABLE_ID=prctbl_...
NEXT_PUBLIC_STRIPE_PRICE_ID=price_...
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

## 2.5 - OpenAI (IA Chat, TTS, Transcrição)
# Obrigatório para: /api/openai/chat, /api/openai/tts, /api/openai/transcribe
# Onde usar: Vercel E desenvolvimento local
OPENAI_API_KEY=sk-proj-...

## 2.6 - Web Search & Crawling (Fase 4 - Opcional)
# Usado por: /api/openai/chat (grounding search)
# Opcional: Firecrawl para crawling avançado, Tavily/Brave para busca web
TAVILY_API_KEY=tvly-...
FIRECRAWL_API_KEY=fc-...
BRAVE_API_KEY=

## 2.7 - System Instructions (Prompt do Chatbot)
# Opcional: Se não definido, usa fallback hardcoded
# Path: Carrega de arquivo Markdown
SYSTEM_INSTRUCTION_PT_BR=
SYSTEM_INSTRUCTION_PT_BR_PATH=prompts/system-instruction.pt-br.md

## 2.8 - Admin Dashboard
# Usado por: /admin/login, /api/admin/*
# Dev: usuário 'admin' com senha 'admin' (texto plano para dev)
# Prod: use hash bcrypt (gere com: npm run admin:hash -- suaSenha)
ADMIN_USERNAME=admin
ADMIN_PASSWORD_HASH=admin
ADMIN_SESSION_SECRET=admin

## 2.9 - Desenvolvimento
# CORS para rotas API (preview alternativo)
ALLOWED_ORIGIN=http://localhost:3001

# Porta do servidor Next.js (WSL padrão: 3001)
PORT=3001

# Fake Auth (apenas desenvolvimento - simulação de autenticação)
# Remove em produção ou deixe vazio
NEXT_PUBLIC_FAKE_AUTH_EMAIL=test@test.com
NEXT_PUBLIC_FAKE_AUTH_PASSWORD=12345678A

# Desabilitar telemetria Next.js (recomendado)
NEXT_TELEMETRY_DISABLED=1

# Mock Webhook (apenas testes - permite /api/webhook/stripe/test em prod)
# NUNCA habilite em produção real
ENABLE_MOCK_WEBHOOK=

#------------------------------------------------------------------------------
# RESUMO DE VARIÁVEIS POR AMBIENTE
#------------------------------------------------------------------------------

# DESENVOLVIMENTO LOCAL (Docker Compose):
# - SEÇÃO 1: Todas as variáveis (infraestrutura Supabase)
# - SEÇÃO 2: Variáveis com valores locais (localhost, dev keys)

# DEPLOY VERCEL (Produção):
# - SEÇÃO 1: NÃO necessário (usa Supabase Cloud)
# - SEÇÃO 2.1-2.9: Configure no Vercel Dashboard com valores de produção
#   Essenciais para Vercel:
#   * NEXT_PUBLIC_WEBSITE_URL (seu domínio Vercel)
#   * NEXT_PUBLIC_SUPABASE_URL (Supabase Cloud)
#   * NEXT_PUBLIC_SUPABASE_ANON_KEY
#   * SUPABASE_URL (mesmo que acima)
#   * SUPABASE_SERVICE_ROLE_KEY
#   * NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY
#   * NEXT_PUBLIC_STRIPE_PRICING_TABLE_ID
#   * STRIPE_SECRET_KEY
#   * STRIPE_WEBHOOK_SECRET (configure webhook: https://seu-dominio.vercel.app/api/webhook/stripe)
#   * OPENAI_API_KEY
#   * ADMIN_USERNAME
#   * ADMIN_PASSWORD_HASH (use hash bcrypt)
#   * ADMIN_SESSION_SECRET (gere com: openssl rand -hex 32)
